---
title: "Trade Statistics Report"
author: "Vanuatu National Statistics Office"
date: "`r format(Sys.Date(), '%d %b %Y')`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: '2'
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r preparation, include=FALSE}

# Load the required libraries
library(knitr) # Nice tables
library(kableExtra) # Extra nice tables
library(dplyr) # Manipulating data
library(openxlsx) # Reading and editing excel formatted files

# Load the general R functions
source("functions.R")
```

## Importing data files

```{r import and process data}

# Read in the raw trade data
# Note that spaces in column names have been automatically replaced with "."s
tradeStatsFile <- file.path("..", "data", "secure", "SEC_PROC_ASY_RawDataAndReferenceTables_31-01-20.xlsx")
tradeStats <- read.xlsx(tradeStatsFile, sheet=1, skipEmptyRows=TRUE)

# Remove the repeated header row from the trade statistics data
tradeStats <- tradeStats[tradeStats$Office != "Office", ]

# Remove duplicated rows from the trade statistics data
duplicatedRows <- duplicated(tradeStats) 
tradeStatsNoDup <- tradeStats[duplicatedRows == FALSE, ]

# Convert the CP4 to a factor
tradeStatsNoDup$CP4 <- as.factor(tradeStats$CP4)

# Convert the statistical value to numeric
tradeStatsNoDup$Stat..Value <- as.numeric(tradeStats$Stat..Value)

# Convert excel figures to dates
tradeStatsNoDup$Reg..Date <- as.Date(as.numeric(tradeStats$Reg..Date), origin="1899-12-30") # For numeric dates excel sets origin to December 30, 1899 (https://stackoverflow.com/questions/43230470/how-to-convert-excel-date-format-to-proper-date-in-r)

# Create subset for Export and Import commodities 
tradeStatsCommodities <- tradeStatsNoDup[tradeStatsNoDup$CP4 %in% c(1000, 3071, 4000, 4071, 7100), ]

# Exclude banknotes from exports
tradeStatsNoBanknotes <- tradeStatsCommodities[tradeStatsCommodities$HS.Code != "49070010", ]

# Extract the 6, 4, and 2 digit HS codes into separate columns
tradeStatsNoBanknotes$HS.Code_6 <- extractCodeSubset(tradeStatsNoBanknotes$HS.Code, nDigits=6)
tradeStatsNoBanknotes$HS.Code_4 <- extractCodeSubset(tradeStatsNoBanknotes$HS.Code, nDigits=4)
tradeStatsNoBanknotes$HS.Code_2 <- extractCodeSubset(tradeStatsNoBanknotes$HS.Code, nDigits=2)

# Extract the 3 and 1 digit SITC codes into separate columns
tradeStatsNoBanknotes$SITC_3 <- extractCodeSubset(tradeStatsNoBanknotes$SITC, nDigits=3)
tradeStatsNoBanknotes$SITC_1 <- extractCodeSubset(tradeStatsNoBanknotes$SITC, nDigits=1)

# Create new columns for dates
tradeStatsNoBanknotes$Year<- format(tradeStatsNoBanknotes$Reg..Date, format= "%Y")
tradeStatsNoBanknotes$Month<- format(tradeStatsNoBanknotes$Reg..Date, format= "%B")
tradeStatsNoBanknotes$Day<- format(tradeStatsNoBanknotes$Reg..Date, format= "%d")

# Quality check indicators (Wgt..Net and Stat..Value) 
tradeStatsNoBanknotes$Wgt..Net <- as.numeric(tradeStatsNoBanknotes$Wgt..Net) # Convert the net weight to numeric
tradeStatsNoBanknotes$PricePerUnit<- tradeStatsNoBanknotes$Stat..Value/tradeStatsNoBanknotes$Wgt..Net # Create new column 
tradeStatsCommoditiesSorted<- tradeStatsNoBanknotes[order(-tradeStatsNoBanknotes$Stat..Value), ] # Sort the stats value in descending order (this isn't working)

# Store principle exports and imports 


# Merge classifications 
tradeStatsFileMergeTransport <- file.path("..", "data", "open", "OPN_FINAL_ASY_ModeOfTransportClassifications_31-01-20.xlsx") # Mode of Transport
modeOfTransport <- read.xlsx(tradeStatsFileMergeTransport, sheet=1, skipEmptyRows=TRUE)
mergedModeOfTransport<- merge(modeOfTransport, tradeStatsNoBanknotes, by= "Office")

tradeStatsFileMergeHSCode <- file.path("..", "data", "open", "OPN_FINAL_ASY_HSCodeClassifications_31-01-20.xlsx") # HS codes
hsDescription <- read.xlsx(tradeStatsFileMergeHSCode, sheet=1, skipEmptyRows=TRUE)
mergedHSCode<- merge(hsDescription, mergedModeOfTransport, by= "HS.Code_2")

tradeStatsFileMergeCountryDesImports <- file.path("..", "data", "open", "OPN_FINAL_ASY_CountryDescriptionImportsClassifications_31-01-20.xlsx") # Country of origin (CO)
countryDescritpionImports <- read.xlsx(tradeStatsFileMergeCountryDesImports, sheet=1, skipEmptyRows=TRUE)
mergedCountryOrigin<- merge(countryDescritpionImports, mergedHSCode, by= "CO")

tradeStatsFileMergeCountryDesImports <- file.path("..", "data", "open", "OPN_FINAL_ASY_CountryDescriptionImportsClassifications_31-01-20.xlsx") # Country of origin (CO)
countryDescritpionImports <- read.xlsx(tradeStatsFileMergeCountryDesImports, sheet=1, skipEmptyRows=TRUE)
mergedCountryOrigin<- merge(countryDescritpionImports, mergedHSCode, by= "CO")

tradeStatsFileMergeSITCCode <- file.path("..", "data", "open", "OPN_FINAL_ASY_SITCCodeClassifications_31-01-20.xlsx") # Country of origin
sitcDescription <- read.xlsx(tradeStatsFileMergeSITCCode, sheet=1, skipEmptyRows=TRUE)
mergedSITCDescription<- merge(sitcDescription, mergedCountryOrigin, by= "SITC_1")

tradeStatsFileMergePrincipleCommodities <- file.path("..", "data", "open", "OPN_FINAL_ASY_PrincipleCommoditiesClassifications_31-01-20.xlsx") # Country of origin
principleCommodties <- read.xlsx(tradeStatsFileMergePrincipleCommodities, sheet=1, skipEmptyRows=TRUE)
mergedPrincipleCommodties<- merge(principleCommodties, mergedSITCDescription, by= "HS.Code")

tradeStatsFileMergeBECDescriptions <- file.path("..", "data", "open", "OPN_FINAL_ASY_BECClassifications_31-01-20.xlsx") # Broad economic categories
becDescriptions <- read.xlsx(tradeStatsFileMergeBECDescriptions, sheet=1, skipEmptyRows=TRUE)
mergedBECDescriptions<- merge(becDescriptions, mergedPrincipleCommodties, by= "HS.Code_6")


# New HS codes and SITC codes stored and we are notified


# Processed data set stored
processedTradeStats<- mergedBECDescriptions

```

## Balance of Trade
```{r calculate balance of trade statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the balance of trade statistics - note that this remove a bit of redundancy
exports <- sum(processedTradeStats[processedTradeStats$CP4 == 1000, "Stat..Value"], na.rm=TRUE) # Added na.rm in case NAs introduced at later date
reExports <- sum(processedTradeStats[processedTradeStats$CP4 == 3071, "Stat..Value"], na.rm=TRUE)
totalExports <- exports + reExports
imports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100), "Stat..Value"], na.rm=TRUE)
balance <- totalExports - imports

# Insert values into table
tradeBalance <- data.frame("Export"=exports, "Re-Export"=reExports, "Total Export"=totalExports, "Imports CIF"=imports, "Trade Balance"=balance)

prettyTable(tradeBalance)
```

```{r insert balance of trade statistics into final formatted table}

# Extremely helpful resource for openxlsx here: https://rdrr.io/cran/openxlsx/

# Note current year and month of data
fileNameParts <- strsplit(tradeStatsFile, split="_")[[1]]
date <- as.Date(strsplit(fileNameParts[length(fileNameParts)], split="\\.")[[1]][1], format="%d-%m-%y")
month <- format(date, "%B")
year <- format(date, "%Y")

# Note the excel workbook containing the final formmatted tables
finalWorkbookFileName <- file.path("..", "outputs", "SEC_FINAL_MAN_FinalTradeStatisticsTables_31-01-20.xlsx")

## Updating the Annual and Monthly sub tables
# Extract the balance of trade data and extract sub tables
balanceOfTradeSubTables <- extractHistoricBalanceOfTradeStatistics(finalWorkbookFileName)

# Update the sub tables for the balance of trade data
balanceOfTradeSubTables <- updateBalanceOfTradeSubTables(balanceOfTradeSubTables, month, year, tradeBalance/1000000)

## Editing the final formatted tables
updatedFinalFormattedBalanceOfTradeTable(finalWorkbookFileName, balanceOfTradeSubTables)
```


## Import by HS Code
```{r calculate import by HS Code statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the Import by HS Code 
animalProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("01", "02", "03", "04", "05"), "Stat..Value"], na.rm=TRUE)
vegtableProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("06", "07", "08", "09", "10", "11", "12", "13", "14"), "Stat..Value"], na.rm=TRUE)
animalOrVegtableProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("15"), "Stat..Value"], na.rm=TRUE)
preparedFoodstuffs <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("16", "17", "18", "19", "20", "21", "22", "23", "24"), "Stat..Value"], na.rm=TRUE)
mineralProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("25", "26", "27"), "Stat..Value"], na.rm=TRUE)
chemicalProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38"), "Stat..Value"], na.rm=TRUE)
platsicThereof <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c( "39", "40"), "Stat..Value"], na.rm=TRUE)
rawHides <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("41", "42", "43"), "Stat..Value"], na.rm=TRUE)
woodMaterial <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("44", "45", "46"), "Stat..Value"], na.rm=TRUE)
woodThereof <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("47", "48", "49"), "Stat..Value"], na.rm=TRUE)
textileArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63"), "Stat..Value"], na.rm=TRUE)
footwearThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("64", "65", "66", "67"), "Stat..Value"], na.rm=TRUE)
articlesStone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("68", "69", "70"), "Stat..Value"], na.rm=TRUE)
pearlsStone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("71"), "Stat..Value"], na.rm=TRUE)
baseMetals<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83"), "Stat..Value"], na.rm=TRUE)
machineryThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("84", "85"), "Stat..Value"], na.rm=TRUE)
vehiclesEquipment<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("86", "87", "88", "89"), "Stat..Value"], na.rm=TRUE)
photographicGoods<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("90", "91", "92"), "Stat..Value"], na.rm=TRUE)
armsThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("93"), "Stat..Value"], na.rm=TRUE)
miscellaneousArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("94", "95", "96"), "Stat..Value"], na.rm=TRUE)
worksArt<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("97"), "Stat..Value"], na.rm=TRUE)
others<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$HS.Code_2 %in% c("98", "99"), "Stat..Value"], na.rm=TRUE)
total<- animalProducts + vegtableProducts + animalOrVegtableProducts + preparedFoodstuffs + mineralProducts + chemicalProducts + platsicThereof + rawHides + woodMaterial + woodThereof + textileArticles + footwearThereof + articlesStone + pearlsStone + baseMetals + machineryThereof + vehiclesEquipment + photographicGoods + armsThereof + miscellaneousArticles + worksArt + others

# Insert values into table
importsByHS <- data.frame("Live animals: animal products"=animalProducts, "Vegetable products"=vegtableProducts, "Animal or vegetable oils & fats"=animalOrVegtableProducts, "Prepared foodstuffs, beverages, spirits & tobacco"=preparedFoodstuffs, "Mineral products"=mineralProducts, "Chemicals and allied products"= chemicalProducts, "Plastic, rubber & articles thereof"= platsicThereof, "Raw hides, skins, leather articles & travel goods"= rawHides, "Wood, cork & articles thereof & plaiting material"= woodMaterial, "Wood pulp, paper & paperboard & articles thereof"= woodThereof, "Textiles & textile articles"= textileArticles, "Footwear, headgear, umbrellas & parts thereof"= footwearThereof, "Articles of stone, plaster, cement, glass & ceremic products"= articlesStone, "Pearls, precious & semi-precious stones & metals"= pearlsStone, "Base metals & articles thereof"= baseMetals, "Machinery & mechanical & electrical appliances & parts thereof"= machineryThereof, "Vehicles, aircraft & associated transport equipment"= vehiclesEquipment, "Photographic & optical, medical & surgical goods & clocks/watches & musical instruments"= photographicGoods, "Arms and ammunition, parts & accessories thereof"= armsThereof, "Miscellaneous manufactured articles"= miscellaneousArticles, "Works of art, collectors pieces & antiques"= worksArt, "Others"= others, "Total
"= total)

prettyTable(importsByHS)

```

```{r insert Import by HS Code into final formatted table}


```

## Export by HS Code

```{r calculate export by HS Code statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the Export by HS Code 
animalProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("01", "02", "03", "04", "05"), "Stat..Value"], na.rm=TRUE)
vegtableProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("06", "07", "08", "09", "10", "11", "12", "13", "14"), "Stat..Value"], na.rm=TRUE)
animalOrVegtableProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("15"), "Stat..Value"], na.rm=TRUE)
preparedFoodstuffs <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("16", "17", "18", "19", "20", "21", "22", "23", "24"), "Stat..Value"], na.rm=TRUE)
mineralProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("25", "26", "27"), "Stat..Value"], na.rm=TRUE)
chemicalProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38"), "Stat..Value"], na.rm=TRUE)
platsicThereof <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c( "39", "40"), "Stat..Value"], na.rm=TRUE)
rawHides <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("41", "42", "43"), "Stat..Value"], na.rm=TRUE)
woodMaterial <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("44", "45", "46"), "Stat..Value"], na.rm=TRUE)
woodThereof <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("47", "48", "49"), "Stat..Value"], na.rm=TRUE)
textileArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63"), "Stat..Value"], na.rm=TRUE)
footwearThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("64", "65", "66", "67"), "Stat..Value"], na.rm=TRUE)
articlesStone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("68", "69", "70"), "Stat..Value"], na.rm=TRUE)
pearlsStone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("71"), "Stat..Value"], na.rm=TRUE)
baseMetals<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83"), "Stat..Value"], na.rm=TRUE)
machineryThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("84", "85"), "Stat..Value"], na.rm=TRUE)
vehiclesEquipment<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("86", "87", "88", "89"), "Stat..Value"], na.rm=TRUE)
photographicGoods<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("90", "91", "92"), "Stat..Value"], na.rm=TRUE)
armsThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("93"), "Stat..Value"], na.rm=TRUE)
miscellaneousArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("94", "95", "96"), "Stat..Value"], na.rm=TRUE)
worksArt<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("97"), "Stat..Value"], na.rm=TRUE)
others<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$HS.Code_2 %in% c("98", "99"), "Stat..Value"], na.rm=TRUE)
total<- animalProducts + vegtableProducts + animalOrVegtableProducts + preparedFoodstuffs + mineralProducts + chemicalProducts + platsicThereof + rawHides + woodMaterial + woodThereof + textileArticles + footwearThereof + articlesStone + pearlsStone + baseMetals + machineryThereof + vehiclesEquipment + photographicGoods + armsThereof + miscellaneousArticles + worksArt + others

# Insert values into table
exportsByHS <- data.frame("Live animals: animal products"=animalProducts, "Vegetable products"=vegtableProducts, "Animal or vegetable oils & fats"=animalOrVegtableProducts, "Prepared foodstuffs, beverages, spirits & tobacco"=preparedFoodstuffs, "Mineral products"=mineralProducts, "Chemicals and allied products"= chemicalProducts, "Plastic, rubber & articles thereof"= platsicThereof, "Raw hides, skins, leather articles & travel goods"= rawHides, "Wood, cork & articles thereof & plaiting material"= woodMaterial, "Wood pulp, paper & paperboard & articles thereof"= woodThereof, "Textiles & textile articles"= textileArticles, "Footwear, headgear, umbrellas & parts thereof"= footwearThereof, "Articles of stone, plaster, cement, glass & ceremic products"= articlesStone, "Pearls, precious & semi-precious stones & metals"= pearlsStone, "Base metals & articles thereof"= baseMetals, "Machinery & mechanical & electrical appliances & parts thereof"= machineryThereof, "Vehicles, aircraft & associated transport equipment"= vehiclesEquipment, "Photographic & optical, medical & surgical goods & clocks/watches & musical instruments"= photographicGoods, "Arms and ammunition, parts & accessories thereof"= armsThereof, "Miscellaneous manufactured articles"= miscellaneousArticles, "Works of art, collectors pieces & antiques"= worksArt, "Others"= others, "Total
"= total)

prettyTable(exportsByHS)

```

```{r insert Export by HS Code into final formatted table}


```


## Re-Export by HS Code

```{r calculate re-export by HS Code statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the Re-Export by HS Code 
animalProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("01", "02", "03", "04", "05"), "Stat..Value"], na.rm=TRUE)
vegtableProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("06", "07", "08", "09", "10", "11", "12", "13", "14"), "Stat..Value"], na.rm=TRUE)
animalOrVegtableProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("15"), "Stat..Value"], na.rm=TRUE)
preparedFoodstuffs <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("16", "17", "18", "19", "20", "21", "22", "23", "24"), "Stat..Value"], na.rm=TRUE)
mineralProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("25", "26", "27"), "Stat..Value"], na.rm=TRUE)
chemicalProducts <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38"), "Stat..Value"], na.rm=TRUE)
platsicThereof <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c( "39", "40"), "Stat..Value"], na.rm=TRUE)
rawHides <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("41", "42", "43"), "Stat..Value"], na.rm=TRUE)
woodMaterial <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("44", "45", "46"), "Stat..Value"], na.rm=TRUE)
woodThereof <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("47", "48", "49"), "Stat..Value"], na.rm=TRUE)
textileArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("50", "51", "52", "53", "54", "55", "56", "57", "58", "59", "60", "61", "62", "63"), "Stat..Value"], na.rm=TRUE)
footwearThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("64", "65", "66", "67"), "Stat..Value"], na.rm=TRUE)
articlesStone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("68", "69", "70"), "Stat..Value"], na.rm=TRUE)
pearlsStone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("71"), "Stat..Value"], na.rm=TRUE)
baseMetals<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("72", "73", "74", "75", "76", "77", "78", "79", "80", "81", "82", "83"), "Stat..Value"], na.rm=TRUE)
machineryThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("84", "85"), "Stat..Value"], na.rm=TRUE)
vehiclesEquipment<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("86", "87", "88", "89"), "Stat..Value"], na.rm=TRUE)
photographicGoods<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("90", "91", "92"), "Stat..Value"], na.rm=TRUE)
armsThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("93"), "Stat..Value"], na.rm=TRUE)
miscellaneousArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("94", "95", "96"), "Stat..Value"], na.rm=TRUE)
worksArt<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("97"), "Stat..Value"], na.rm=TRUE)
others<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$HS.Code_2 %in% c("98", "99"), "Stat..Value"], na.rm=TRUE)
total<- animalProducts + vegtableProducts + animalOrVegtableProducts + preparedFoodstuffs + mineralProducts + chemicalProducts + platsicThereof + rawHides + woodMaterial + woodThereof + textileArticles + footwearThereof + articlesStone + pearlsStone + baseMetals + machineryThereof + vehiclesEquipment + photographicGoods + armsThereof + miscellaneousArticles + worksArt + others

# Insert values into table
reExportsByHS <- data.frame("Live animals: animal products"=animalProducts, "Vegetable products"=vegtableProducts, "Animal or vegetable oils & fats"=animalOrVegtableProducts, "Prepared foodstuffs, beverages, spirits & tobacco"=preparedFoodstuffs, "Mineral products"=mineralProducts, "Chemicals and allied products"= chemicalProducts, "Plastic, rubber & articles thereof"= platsicThereof, "Raw hides, skins, leather articles & travel goods"= rawHides, "Wood, cork & articles thereof & plaiting material"= woodMaterial, "Wood pulp, paper & paperboard & articles thereof"= woodThereof, "Textiles & textile articles"= textileArticles, "Footwear, headgear, umbrellas & parts thereof"= footwearThereof, "Articles of stone, plaster, cement, glass & ceremic products"= articlesStone, "Pearls, precious & semi-precious stones & metals"= pearlsStone, "Base metals & articles thereof"= baseMetals, "Machinery & mechanical & electrical appliances & parts thereof"= machineryThereof, "Vehicles, aircraft & associated transport equipment"= vehiclesEquipment, "Photographic & optical, medical & surgical goods & clocks/watches & musical instruments"= photographicGoods, "Arms and ammunition, parts & accessories thereof"= armsThereof, "Miscellaneous manufactured articles"= miscellaneousArticles, "Works of art, collectors pieces & antiques"= worksArt, "Others"= others, "Total
"= total)

prettyTable(reExportsByHS)

```

```{r insert Re-Export by HS Code into final formatted table}

```


## Total Exports by HS Code

```{r calculate total exports by HS Code statistics with base R, eval=FALSE, echo=FALSE}

# Insert values into table
totalExportsByHS <- exportsByHS + reExportsByHS

prettyTable(totalExportsByHS)

```

```{r insert Total Exports by HS Code into final formatted table}

```

## Principle Exports

```{r calculate principle exports statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the principle Exports 
alcoholicDrinks<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("ALCOHOLIC DRINKS"), "Stat..Value"], na.rm=TRUE)

beef<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("BEEF"), "Stat..Value"], na.rm=TRUE)

cocoa <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("COCOA"), "Stat..Value"], na.rm=TRUE)

coconutMeal <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)

coconutOil <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("COCONUT OIL"), "Stat..Value"], na.rm=TRUE)

coffeeAllTypes <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("COFFEE"), "Stat..Value"], na.rm=TRUE)

copra <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("COPRA", "COPRA MEAL"), "Stat..Value"], na.rm=TRUE)

cowhides <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("COWHIDES"), "Stat..Value"], na.rm=TRUE)

fishTuna<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("TUNA FISH"), "Stat..Value"], na.rm=TRUE)

kava<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("KAVA"), "Stat..Value"], na.rm=TRUE)

ornamentalFish<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("LIFE FISH"), "Stat..Value"], na.rm=TRUE)

ornamentalFish<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("LIFE FISH"), "Stat..Value"], na.rm=TRUE)

woodArticles<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("WOOD"), "Stat..Value"], na.rm=TRUE)

shellButtons<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)

vanilla<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("VANILLA"), "Stat..Value"], na.rm=TRUE)

otherProducts<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("OTHER PRODUCTS"), "Stat..Value"], na.rm=TRUE)

totalPrincipleExports<- alcoholicDrinks + beef + cocoa + coconutMeal + coconutOil + coffeeAllTypes + copra + cowhides + fishTuna + kava + ornamentalFish + woodArticles + shellButtons + vanilla + otherProducts

# Insert values into table
totalPExports <- data.frame("Alcoholic Drinks"=alcoholicDrinks, "Beef fresh, chilled, frozen and preserved"=beef, "Cocoa"=cocoa, "Coconut Meal"=coconutMeal, "Coconut oil"=coconutOil, "Coffee, all types"= coffeeAllTypes, "Copra"= copra, "Cowhides"= cowhides, "Fish: Tuna"= fishTuna, "Kava"= kava, "Ornamental fish"= ornamentalFish, "Wood and articles of wood; wood charcoal"= woodArticles, "Shell buttons"= shellButtons, "Vanilla"= vanilla, "Other products"= otherProducts, "Total exports"= totalPrincipleExports) 

prettyTable(totalPExports)


# Calculate the principle Re-Exports 
alcoholicDrinks<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("ALCOHOLIC DRINKS"), "Stat..Value"], na.rm=TRUE)

tobacco<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("CIGARETTES containing tobacco"), "Stat..Value"], na.rm=TRUE)

fuel<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("FUEL"), "Stat..Value"], na.rm=TRUE)

otherReProducts<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(3071) & processedTradeStats$PRINCIPAL.EXPORTS %in% c("OTHER PRODUCTS"), "Stat..Value"], na.rm=TRUE)

totalPrincipleReExports<- alcoholicDrinks + tobacco + fuel + otherReProducts 

# Insert values into table
totalRePExports <- data.frame("Alcoholic Drinks"=alcoholicDrinks, "Tobacco and cigarettes"=tobacco, "Fuel"=fuel, "Other products"=otherReProducts, "Total re-exports"=totalPrincipleReExports) 

prettyTable(totalRePExports)

# Total Exports and Re-Exports
totalPrincipleExportsandReExports <- totalPrincipleExports + totalPrincipleReExports

prettyTable(totalPrincipleExportsandReExports)

```

```{r insert Principle Exports into final formatted table}

```


## Principle Imports

```{r calculate principle imports statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the principle Imports 
meat<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Meat and edible offal of poultry"), "Stat..Value"], na.rm=TRUE)

fish<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Fish and crustaceans, molluscs and other aquatic invertebrates"), "Stat..Value"], na.rm=TRUE)

milk<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Milk and Cream"), "Stat..Value"], na.rm=TRUE)

rice<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("RICE"), "Stat..Value"], na.rm=TRUE)

wheat<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Wheat or meslin flour"), "Stat..Value"], na.rm=TRUE)

preparedMeat<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)

preparedFish<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Prepared or preserved fish"), "Stat..Value"], na.rm=TRUE)

sugar<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Sugar"), "Stat..Value"], na.rm=TRUE)

pasta<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Pasta, whether cooked or stuffed or otherwise prepared, such as spaghetti, macaroni, noodles, lasagne, gnocchi, ravioli, cannelloni; couscous"), "Stat..Value"], na.rm=TRUE)

preparedFoods<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Prepared foods obtained by the swelling or roasting of cereals or cereal products eg corn flakes; cereals (excl maize) in grain or flakes"), "Stat..Value"], na.rm=TRUE)

bread<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)

nonAlcoholic<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Non-alcoholic drinks including mineral water"), "Stat..Value"], na.rm=TRUE)

alcoholic<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("ALCOHOLIC DRINKS"), "Stat..Value"], na.rm=TRUE)

animalFeeding<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Preparations of a kind used in animal feeding"), "Stat..Value"], na.rm=TRUE)

tobaccoProducts<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Cigars, cheroots, cigarillos and cigarettes, of tobacco or of tobacco substitutes"), "Stat..Value"], na.rm=TRUE)

cement<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Portland cement, aluminous cement, slag cement, supersulphate cement and similar hydraulic cements"), "Stat..Value"], na.rm=TRUE)

petroleum<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Petroleum oils and oils obtained from bituminous minerals"), "Stat..Value"], na.rm=TRUE)

hydrocarbons<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)

medicaments<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Medicaments"), "Stat..Value"], na.rm=TRUE)

perfumes<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Perfumes, make-up preparations and preparations for the care of the skin (excl medicaments) and products for hair"), "Stat..Value"], na.rm=TRUE)

pipes<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Tubes, pipes and hoses, and fittings therefor (for example, joints, elbows, flanges), of plastics."), "Stat..Value"], na.rm=TRUE)

lids<-sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Articles for the conveyance or packing of goods; stoppers, lids, caps and other closures, of plastics"), "Stat..Value"], na.rm=TRUE)  

tires<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("New pneumatic tires, of rubber"), "Stat..Value"], na.rm=TRUE)

wood<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Wood sawn or chipped lengthwise, sliced or peeled, whether or not planed, sanded or end-jointed"), "Stat..Value"], na.rm=TRUE)

toiletPaper<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Toilet paper and similar paper"), "Stat..Value"], na.rm=TRUE)

printedBooks<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Printed books, brochures, leaflets and similar printed matter"), "Stat..Value"], na.rm=TRUE)

clothing<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c("Articles of apparel and clothing accessories"), "Stat..Value"], na.rm=TRUE)

textileClothing<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)
  
footwear<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)  
  
ironSteel<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)  
  
articlesIronSteel<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE)   
  
aluminiumThereof<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

engines<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

refridgerators<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

purifyingMachinery<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

bulldozers<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

dataProcessingMachines<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

electricConverters<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

telephone<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

conductors<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

motorVehiclesPassengers<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

motorVehiclesGoods<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

partsAircraft<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

yachts<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

furniture<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

personalEffects<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 

otherImports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$PRINCIPAL.IMPORTS %in% c(""), "Stat..Value"], na.rm=TRUE) 
  
totalPrincipleImports<- meat + fish + milk + rice + wheat + preparedMeat + preparedFish + sugar + pasta + preparedFoods + bread + nonAlcoholic + alcoholic + animalFeeding + tobaccoProducts + cement + petroleum + hydrocarbons + medicaments + perfumes + pipes + lids + tires + wood + toiletPaper + printedBooks + clothing + textileClothing + footwear + ironSteel + articlesIronSteel + aluminiumThereof + engines + refridgerators + purifyingMachinery + bulldozers + dataProcessingMachines + electricConverters + telephone + conductors + motorVehiclesPassengers + motorVehiclesGoods + partsAircraft + yachts + furniture + personalEffects + otherImports


# Insert values into table
totalPImports <- data.frame("Meat and edible offal of poultry"= meat, "Fish and crustaceans, molluscs and other aquatic invertebrates"= fish, "Milk and Cream"= milk, "Rice"= rice, "Wheat or meslin flour"= wheat, "Other prepared or preserved meat, meat offal or blood"= preparedMeat, "Prepared or preserved fish"= preparedFish, "Sugar"= sugar, "Pasta, whether cooked or stuffed or otherwise prepared, such as spaghetti, macaroni, noodles, lasagne, gnocchi, ravioli, cannelloni; couscous"= pasta, "Prepared foods obtained by the swelling or roasting of cereals or cereal products eg corn flakes; cereals (excl maize) in grain or flakes"= preparedFoods, "Bread, pastry, cakes, biscuits and other bakers' wares"= bread, "Non-alcoholic drinks including mineral water"= nonAlcoholic, "Alcoholic drinks"= alcoholic, "Preparations of a kind used in animal feeding"= animalFeeding, "Cigars, cheroots, cigarillos and cigarettes, of tobacco or of tobacco substitutes"= tobaccoProducts, "Portland cement, aluminous cement, slag cement, supersulphate cement and similar hydraulic cements"= cement, "Petroleum oils and oils obtained from bituminous minerals"= petroleum, "Petroleum gases and other gaseous hydrocarbons"= hydrocarbons, "Medicaments"= medicaments, "Perfumes, make-up preparations and preparations for the care of the skin (excl medicaments) and products for hair"= perfumes, "Tubes, pipes and hoses, and fittings therefor (for example, joints, elbows, flanges), of plastics."= pipes, "Articles for the conveyance or packing of goods; stoppers, lids, caps and other closures, of plastics"= lids, "New pneumatic tires, of rubber"= tires, "Wood sawn or chipped lengthwise, sliced or peeled, whether or not planed, sanded or end-jointed"= wood, "Toilet paper and similar paper"= toiletPaper, "Printed books, brochures, leaflets and similar printed matter"= printedBooks, "Articles of apparel and clothing accessories"= clothing, "Other made up textile articles; sets; worn clothing and worn textile articles; rags"= textileClothing, "Footwear, gaiters and the like; parts of such articles"= footwear, "Iron and steel"= ironSteel, "Articles of iron or steel"= articlesIronSteel, "Aluminium and articles thereof"= aluminiumThereof, "Spark-ignition reciprocating or rotary internal combustion piston engines and compression-ignition internal combustion piston engines (diesel or semi-diesel engines)"= engines, "Refrigerators, freezers and other refrigerating or freezing equipment, electric or other; heat pumps other than air conditioning machines"= refridgerators, "Centrifuges, including centrifugal dryers; filtering or purifying machinery and apparatus, for liquids or gases"= purifyingMachinery, "Self-propelled bulldozers, angledozers, graders, levellers, scrapers, mechanical shovels, excavators, shovel loaders, tamping machines and road rollers"= bulldozers, "Automatic data processing machines; magnetic or optical readers, machines for transcribing data onto data media in coded form and machines for processing such data."= dataProcessingMachines, "Electric generating sets and rotary converters"= electricConverters, "Telephone sets, including telephones for cellular networks or for other wireless networks"= telephone, "Insulated wire, cable and other insulated electric conductors, whether or not fitted with connectors; optical fibre cables, made up of individually sheathed fibres, whether or not assembled with electric conductors or fitted with connectors"= conductors, "Motor vehicles for the transport of passengers"= motorVehiclesPassengers, "Motor vehicles for the transport of goods"= motorVehiclesGoods, "Parts of aircraft"= partsAircraft, "Yachts and other vessels for pleasure or sports; rowing boats and canoes"= yachts, "Other furniture and parts thereof"= furniture, "Personal and household effects"= personalEffects, "Other Imports"= otherImports, "TOTAL IMPORTS"= totalPrincipleImports) 

prettyTable(totalPImports)




```

```{r insert Principle Imports into final formatted table}

```


## Balance of Trade by Major Partner Countries
```{r calculate balance of trade by major partner countries statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the Balance of Trade by Major Partner Countries

australiaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("AUSTRALIA"), "Stat..Value"], na.rm=TRUE)
australiaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("AUSTRALIA"), "Stat..Value"], na.rm=TRUE)
australiaBalance<- australiaExports - australiaImports

chinaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("CHINA, PEOPLES REPUBLIC OF"), "Stat..Value"], na.rm=TRUE)
chinaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("CHINA, PEOPLES REPUBLIC OF"), "Stat..Value"], na.rm=TRUE)
chinaBalance<- chinaExports - chinaImports

fijiExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("FIJI"), "Stat..Value"], na.rm=TRUE)
fijiImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("FIJI"), "Stat..Value"], na.rm=TRUE)
fijiBalance<- fijiExports - fijiImports	

franceExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("FRANCE"), "Stat..Value"], na.rm=TRUE)
franceImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("FRANCE"), "Stat..Value"], na.rm=TRUE)
franceBalance<- franceExports - franceImports

hongkongExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("HONG KONG"), "Stat..Value"], na.rm=TRUE)
hongkongImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("HONG KONG"), "Stat..Value"], na.rm=TRUE)
hongkongBalance<- hongkongExports - hongkongImports

indiaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("INDIA"), "Stat..Value"], na.rm=TRUE)
indiaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("INDIA"), "Stat..Value"], na.rm=TRUE)
indiaBalance<- indiaExports - indiaImports

indonesiaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("INDONESIA"), "Stat..Value"], na.rm=TRUE)
indonesiaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("INDONESIA"), "Stat..Value"], na.rm=TRUE)
indonesiaBalance<- indonesiaExports - indonesiaImports

japanExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("JAPAN"), "Stat..Value"], na.rm=TRUE)
japanImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("JAPAN"), "Stat..Value"], na.rm=TRUE)
japanBalance<- japanExports - japanImports

koreaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("KOREA, REPUBLIC OF"), "Stat..Value"], na.rm=TRUE)
koreaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("KOREA, REPUBLIC OF"), "Stat..Value"], na.rm=TRUE)
koreaBalance<- koreaExports - koreaImports

malaysiaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("MALAYSIA"), "Stat..Value"], na.rm=TRUE)
malaysiaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("MALAYSIA"), "Stat..Value"], na.rm=TRUE)
malaysiaBalance<- malaysiaExports - malaysiaImports

netherlandsExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("NETHERLANDS"), "Stat..Value"], na.rm=TRUE)
netherlandsImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("NETHERLANDS"), "Stat..Value"], na.rm=TRUE)
netherlandsBalance<- netherlandsExports - netherlandsImports

newCaledoniaExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("NEW CALEDONIA"), "Stat..Value"], na.rm=TRUE)
newCaledoniaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("NEW CALEDONIA"), "Stat..Value"], na.rm=TRUE)
newCaledoniaBalance<- newCaledoniaExports - newCaledoniaImports

newZealandExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("NEW ZEALAND"), "Stat..Value"], na.rm=TRUE)
newZealandImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("NEW ZEALAND"), "Stat..Value"], na.rm=TRUE)
newZealandBalance<- newZealandExports - newZealandImports

papuaNewGuineaExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("PAPUA NEW GUINEA"), "Stat..Value"], na.rm=TRUE)
papuaNewGuineaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("PAPA NEW GUINEA"), "Stat..Value"], na.rm=TRUE)
papuaNewGuineaBalance<- papuaNewGuineaExports - papuaNewGuineaImports

philippinesExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("PHILIPPINES"), "Stat..Value"], na.rm=TRUE)
philippinesImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("PHILIPPINES"), "Stat..Value"], na.rm=TRUE)
philippinesBalance<- philippinesExports - philippinesImports

singaporeExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("SINGAPORE"), "Stat..Value"], na.rm=TRUE)
singaporeImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("SINGAPORE"), "Stat..Value"], na.rm=TRUE)
singaporeBalance<- singaporeExports - singaporeImports

solomonIslandsExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("SOLOMON ISLANDS"), "Stat..Value"], na.rm=TRUE)
solomonIslandsImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("SOLOMON ISLANDS"), "Stat..Value"], na.rm=TRUE)
solomonIslandsBalance<- solomonIslandsExports - solomonIslandsImports

thailandExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("THAILAND"), "Stat..Value"], na.rm=TRUE)
thailandImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("THAILAND"), "Stat..Value"], na.rm=TRUE)
thailandBalance<- thailandExports - thailandImports

ukExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("UNITED KINGDOM"), "Stat..Value"], na.rm=TRUE)
ukImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("UNITED KINGDOM"), "Stat..Value"], na.rm=TRUE)
ukBalance<- ukExports - ukImports

americaExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("INITED STATES OF AMERICA"), "Stat..Value"], na.rm=TRUE)
americaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("UNITED STATES OF AMERICA"), "Stat..Value"], na.rm=TRUE)
americaBalance<- americaExports - americaImports

allOthersExports<- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$COUNTRY %in% c("ALL OTHERS"), "Stat..Value"], na.rm=TRUE)
allOthersImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$COUNTRY %in% c("UNITED STATES OF AMERICA"), "Stat..Value"], na.rm=TRUE)
allOthersBalance<- allOthersExports - allOthersImports

totalPCExports<- australiaExports + chinaExports + fijiExports + franceExports + hongkongExports + indiaExports + indonesiaExports + japanExports + koreaExports + malaysiaExports + netherlandsExports + newCaledoniaExports + newZealandExports + papuaNewGuineaExports + philippinesExports + singaporeExports + solomonIslandsExports + thailandExports + ukExports + americaExports + allOthersExports

totalPCImports<- australiaImports + chinaImports + fijiImports + franceImports + hongkongImports + indiaImports + indonesiaImports + japanImports + koreaImports + malaysiaImports + netherlandsImports + newCaledoniaImports + newZealandImports + papuaNewGuineaImports + philippinesImports + singaporeImports + solomonIslandsImports + thailandImports + ukImports + americaImports + allOthersImports

totalPCBalance<- totalPCExports - totalPCImports

# Insert values into table
balanceOfTradeByMajorPartnerCountries <- data.frame("Australia: Exports"=australiaExports, "Australia: Imports"=australiaImports, "Australia: Balance"= australiaBalance, "China, People's Republic of: Exports"=chinaExports, "China, People's Republic of: Imports"=chinaImports, "China, People's Republic of: Balance"= chinaBalance, "Fiji: Exports"=fijiExports, "Fiji: Imports"=fijiImports, "Fiji: Balance"= fijiBalance, "France: Exports"=franceExports, "France: Imports"=franceImports, "France: Balance"= franceBalance, "Hong Kong: Exports"=hongkongExports, "Hong Kong: Imports"=hongkongImports, "Hong Kong: Balance"= hongkongBalance, "India: Exports"=indiaExports, "India: Imports"=indiaImports, "India: Balance"= indiaBalance, "Indonesia: Exports"=indonesiaExports, "Indonesia: Imports"=indonesiaImports, "Indonesia: Balance"= indonesiaBalance, "Japan: Exports"=japanExports, "Japan: Imports"=japanImports, "Japan: Balance"= japanBalance, "Korea, Republic of: Exports"=koreaExports, "Korea, Republic of: Imports"=koreaImports, "Korea, Republic of: Balance"= koreaBalance, "Malaysia: Exports"=malaysiaExports, "Malaysia: Imports"=malaysiaImports, "Malaysia: Balance"= malaysiaBalance, "Netherlands: Exports"=netherlandsExports, "Netherlands: Imports"=netherlandsImports, "Netherlands: Balance"= netherlandsBalance, "New Caledonia: Exports"=newCaledoniaExports, "New Caledonia: Imports"=newCaledoniaImports, "New Caledonia: Balance"= newCaledoniaBalance,
"New Zealand: Exports"=newZealandExports, "New Zealand: Imports"=newZealandImports, "New Zealand: Balance"= newZealandBalance, "Papua NEW Guinea: Exports"=papuaNewGuineaExports, "Papua New Guinea: Imports"=papuaNewGuineaImports, "Papua New Guinea: Balance"= papuaNewGuineaBalance, "Philippines: Exports"=philippinesExports, "Philippines: Imports"=philippinesImports, "Philippines: Balance"= philippinesBalance, "Singapore: Exports"=singaporeExports, "Singapore: Imports"=singaporeImports, "Singapore: Balance"= singaporeBalance, "Solomon Islands: Exports"=solomonIslandsExports, "Solomon Islands: Imports"=solomonIslandsImports, "Solomon Islands: Balance"= solomonIslandsBalance, "Solomon Islands: Exports"=solomonIslandsExports, "Solomon Islands: Imports"=solomonIslandsImports, "Solomon Islands: Balance"= solomonIslandsBalance, "Thailand: Exports"=thailandExports, "Thailand: Imports"=thailandImports, "thailand: Balance"= thailandBalance, "United Kingdon: Exports"=ukExports, "United Kingdom: Imports"=ukImports, "United Kingdom: Balance"= ukBalance, "United States of America: Exports"=americaExports, "United States of America: Imports"=americaImports, "United States of America: Balance"= americaBalance, "All Others: Exports"=allOthersExports, "All Others: Imports"=allOthersImports, "All Others: Balance"= allOthersBalance, "Total: Exports"=totalPCExports, "Total: Imports"=totalPCImports, "Total: Balance"= totalPCBalance)
                                                    
prettyTable(balanceOfTradeByMajorPartnerCountries)

```

```{r insert balance of trade by major partner countries into final formatted table}


```


## Balance of Trade by Region
```{r calculate balance of trade by region statistics with base R, eval=FALSE, echo=FALSE}

# Calculate the Balance of Trade by Region

africaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$REGION %in% c("AFRICA"), "Stat..Value"], na.rm=TRUE)
africaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$REGION %in% c("AFRICA"), "Stat..Value"], na.rm=TRUE)
africaBalance<- africaExports - africaImports

theAmericasExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$REGION %in% c("AMERICAS"), "Stat..Value"], na.rm=TRUE)
theAmericasImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$REGION %in% c("AMERICAS"), "Stat..Value"], na.rm=TRUE)
theAmericasBalance<- theAmericasExports - theAmericasImports

asiaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$REGION %in% c("ASIA"), "Stat..Value"], na.rm=TRUE)
asiaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$REGION %in% c("ASIA"), "Stat..Value"], na.rm=TRUE)
asiaBalance<- asiaExports - asiaImports

europeExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$REGION %in% c("EUROPE"), "Stat..Value"], na.rm=TRUE)
europeImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$REGION %in% c("EUROPE"), "Stat..Value"], na.rm=TRUE)
europeBalance<- europeExports - europeImports

oceaniaExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$REGION %in% c("OCEANIA"), "Stat..Value"], na.rm=TRUE)
oceaniaImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$REGION %in% c("OCEANIA"), "Stat..Value"], na.rm=TRUE)
oceaniaBalance<- oceaniaExports - oceaniaImports

variousExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$REGION %in% c("VARIOUS"), "Stat..Value"], na.rm=TRUE)
variousImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$REGION %in% c("VARIOUS"), "Stat..Value"], na.rm=TRUE)
variousBalance<- variousExports - variousImports

totalRegionExports<- africaExports + theAmericasExports + asiaExports + europeExports + oceaniaExports + variousExports
totalRegionImports<- africaImports + theAmericasImports + asiaImports + europeImports + oceaniaImports + variousImports
totalRegionBalance<- totalRegionExports - totalRegionImports

pictsExports<- oceaniaExports - australiaExports - newZealandExports
pictsImports<- oceaniaImports - australiaImports - newZealandImports
pictsBalance<- oceaniaBalance - australiaBalance - newZealandBalance


# Insert values into table
balanceOfTradeByRegion <- data.frame("Africa: Exports"=africaExports, "Africa: Imports"=africaImports, "Africa: Balance"= africaBalance, "The Americas: Exports"=theAmericasExports, "The Americas: Imports"=theAmericasImports, "The Americas: Balance"= theAmericasBalance, "Asia: Exports"=asiaExports, "Asia: Imports"=asiaImports, "Asia: Balance"= asiaBalance, "Europe: Exports"=europeExports, "Europe: Imports"=europeImports, "Europe: Balance"= europeBalance, "Oceania: Exports"=oceaniaExports, "Oceania: Imports"=oceaniaImports, "Oceania: Balance"= oceaniaBalance, "Various: Exports"=variousExports, "Various: Imports"=variousImports, "Various: Balance"= variousBalance, "Total: Exports"=totalRegionExports, "Total: Imports"=totalRegionImports, "Total: Balance"= totalRegionBalance, "of which the PICTs: Exports"=pictsExports, "of which the PICTs: Imports"=pictsImports, "of which the PICTs: Balance"= pictsBalance)
                                                    
prettyTable(balanceOfTradeByRegion)

```

```{r insert balance of trade by Region into final formatted table}


```


## Trade by Mode of Transport 
```{r calculate trade by mode of transport statistics with base R, eval=FALSE, echo=FALSE}

# Calculate Trade by Mode of Transport

airExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$Mode.of.Transport %in% c("AIR"), "Stat..Value"], na.rm=TRUE)
airImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$Mode.of.Transport %in% c("AIR"), "Stat..Value"], na.rm=TRUE)

waterExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$Mode.of.Transport %in% c("WATER"), "Stat..Value"], na.rm=TRUE)
waterImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$Mode.of.Transport %in% c("WATER"), "Stat..Value"], na.rm=TRUE)

landExports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(1000, 3071) & processedTradeStats$Mode.of.Transport %in% c("LAND"), "Stat..Value"], na.rm=TRUE)
landImports <- sum(processedTradeStats[processedTradeStats$CP4 %in% c(4000, 4071, 7100) & processedTradeStats$Mode.of.Transport %in% c("LAND"), "Stat..Value"], na.rm=TRUE)

# Insert values into table
tradebyModeOfTransport <- data.frame("Air: Exports"=airExports, "Air: Imports"=airImports, "Water: Exports"=airExports, "Water: Imports"=waterImports, "Land: Exports"=landExports, "Land: Imports"=landImports)
                                                    
prettyTable(tradebyModeOfTransport)

```

```{r insert balance of trade by Region into final formatted table}


```