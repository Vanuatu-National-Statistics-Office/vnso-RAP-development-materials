---
title: "Trade Statistics Report"
author: "Vanuatu National Statistics Office"
date: "`r format(Sys.Date(), '%d %b %Y')`"
output:
  html_document:
    number_sections: yes
    toc: yes
    toc_depth: '2'
    toc_float: yes
  pdf_document:
    toc: yes
    toc_depth: '2'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load required libraries, include=FALSE}
library(knitr) # Nice tables
library(kableExtra) # Extra nice tables
library(dplyr)
library(xlsx)

```

```{r functions, include=FALSE}
prettyTable <- function(table){
  
  # Use the kable function to create a nicer formatted table
  kable(table) %>%
  
    # Set the format
    kable_styling(bootstrap_options="striped", # Set the colour of rows
                  full_width=FALSE, # Make the table not stretch to fit the page
                  position="left") %>% # Position the table on the left
  
    # Make the table scrollable
    scroll_box(height = "400px")
}
```

## Setting Working Directory

```{r set working directory}
# Note the name of our working directory
#workingDirectory <- file.path("C:\RTraining\Repositories\vnso-RAP-tradeStats-materials")

# Set the working directory
#setwd(workingDirectory)
```

## Importing data files

```{r}

tradestats <- read.csv(file.path("..", "data", "secure", "Trade_January_2020.csv"), header=TRUE)

```


## Trade Balance
```{r Trade Balance}
tbalance <- tradestats %>%
  #group_by(Type) %>%
  summarise(
            "Export" = sum(Stat..Value[CP4==1000]),
            "Re-Export" = sum(Stat..Value[CP4==3071]),
            "Total Export" = sum(Stat..Value[CP4==1000])+sum(Stat..Value[CP4==3071]),
            "Imports CIF" = sum(Stat..Value[CP4==4000]) + sum(Stat..Value[CP4==4071])+ sum(Stat..Value[CP4==7100]),
            "Trade Balance" = (sum(Stat..Value[CP4==1000])+sum(Stat..Value[CP4==3071])) - (sum(Stat..Value[CP4==4000]) + sum(Stat..Value[CP4==4071])+ sum(Stat..Value[CP4==7100])
            ))

prettyTable(tbalance)

```






